# Wasmer configuration file
# This configures how Wasmer builds and deploys your application

[package]
name = "fee-admin"
version = "1.0.0"
description = "Multi-Tenant School Management SaaS"

[build]
# PHP version - use 8.4 to match composer.lock requirements
php = "8.4"

# Build command - fix Dockerfile after Shipit generates it, then build
build-command = "bash -c 'find . -path \"*/.shipit/docker/Dockerfile\" -type f -exec sed -i \"/pie install php\\/pdo_pgsql/d\" {} \\; -exec sed -i \"/libpq-dev/d\" {} \\; -exec sed -i \"/postgresql-dev/d\" {} \\; && composer install --optimize-autoloader --no-dev --no-scripts && npm ci && npm run build'"

# Start command  
start-command = "php artisan serve --host=0.0.0.0 --port=8080"